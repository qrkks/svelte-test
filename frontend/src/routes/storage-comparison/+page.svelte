<script>
	import { storage, sessionStorage } from '$lib/utils/safe-storage.js';
	
	let localData = $state('');
	let sessionData = $state('');
	let testMessage = $state('');
	
	// é¡µé¢åŠ è½½æ—¶è¯»å–æ•°æ®
	localData = storage.get('localTest', '');
	sessionData = sessionStorage.get('sessionTest', '');
	
	function saveToLocal() {
		storage.set('localTest', localData);
		testMessage = 'âœ… å·²ä¿å­˜åˆ°localStorage - å…³é—­æ ‡ç­¾é¡µé‡æ–°æ‰“å¼€ï¼Œæ•°æ®ä»ç„¶å­˜åœ¨ï¼';
		setTimeout(() => testMessage = '', 3000);
	}
	
	function saveToSession() {
		sessionStorage.set('sessionTest', sessionData);
		testMessage = 'âœ… å·²ä¿å­˜åˆ°sessionStorage - å…³é—­æ ‡ç­¾é¡µé‡æ–°æ‰“å¼€ï¼Œæ•°æ®ä¼šæ¶ˆå¤±ï¼';
		setTimeout(() => testMessage = '', 3000);
	}
	
	function clearLocal() {
		storage.remove('localTest');
		localData = '';
		testMessage = 'ğŸ—‘ï¸ localStorageæ•°æ®å·²æ¸…é™¤';
		setTimeout(() => testMessage = '', 2000);
	}
	
	function clearSession() {
		sessionStorage.remove('sessionTest');
		sessionData = '';
		testMessage = 'ğŸ—‘ï¸ sessionStorageæ•°æ®å·²æ¸…é™¤';
		setTimeout(() => testMessage = '', 2000);
	}
	
	function openNewTab() {
		window.open(window.location.href, '_blank');
		testMessage = 'ğŸ†• æ–°æ ‡ç­¾é¡µå·²æ‰“å¼€ - è§‚å¯ŸlocalStorageæ•°æ®æ˜¯å¦å…±äº«ï¼ŒsessionStorageæ•°æ®æ˜¯å¦ç‹¬ç«‹ï¼';
		setTimeout(() => testMessage = '', 4000);
	}
</script>

<div class="container">
	<h1>localStorage vs sessionStorage</h1>
	
	<div class="comparison-grid">
		<!-- localStorageéƒ¨åˆ† -->
		<div class="storage-section local">
			<h2>ğŸ”„ localStorage</h2>
			<div class="features">
				<p>âœ… æ°¸ä¹…ä¿å­˜ï¼ˆé™¤éæ‰‹åŠ¨åˆ é™¤ï¼‰</p>
				<p>âœ… æ‰€æœ‰æ ‡ç­¾é¡µå…±äº«</p>
				<p>âœ… é€‚åˆç”¨æˆ·åå¥½ã€è®¾ç½®ç­‰</p>
			</div>
			
			<div class="demo-area">
				<textarea 
					bind:value={localData} 
					placeholder="è¾“å…¥è¦ä¿å­˜åˆ°localStorageçš„æ•°æ®..."
					rows="3"
				></textarea>
				<div class="buttons">
					<button onclick={saveToLocal} class="save">ä¿å­˜åˆ°localStorage</button>
					<button onclick={clearLocal} class="clear">æ¸…é™¤</button>
				</div>
			</div>
		</div>
		
		<!-- sessionStorageéƒ¨åˆ† -->
		<div class="storage-section session">
			<h2>â±ï¸ sessionStorage</h2>
			<div class="features">
				<p>âš¡ æ ‡ç­¾é¡µå…³é—­åæ¶ˆå¤±</p>
				<p>ğŸ”’ ä»…å½“å‰æ ‡ç­¾é¡µå¯ç”¨</p>
				<p>ğŸ“ é€‚åˆä¸´æ—¶æ•°æ®ã€è‰ç¨¿ç­‰</p>
			</div>
			
			<div class="demo-area">
				<textarea 
					bind:value={sessionData} 
					placeholder="è¾“å…¥è¦ä¿å­˜åˆ°sessionStorageçš„æ•°æ®..."
					rows="3"
				></textarea>
				<div class="buttons">
					<button onclick={saveToSession} class="save">ä¿å­˜åˆ°sessionStorage</button>
					<button onclick={clearSession} class="clear">æ¸…é™¤</button>
				</div>
			</div>
		</div>
	</div>
	
	<!-- æµ‹è¯•åŒºåŸŸ -->
	<div class="test-section">
		<h2>ğŸ§ª æµ‹è¯•åŒºåŸŸ</h2>
		<div class="test-buttons">
			<button onclick={openNewTab} class="test">æ‰“å¼€æ–°æ ‡ç­¾é¡µæµ‹è¯•</button>
		</div>
		
		<div class="instructions">
			<h3>ğŸ“‹ æµ‹è¯•æ­¥éª¤ï¼š</h3>
			<ol>
				<li>åœ¨ä¸¤ä¸ªè¾“å…¥æ¡†ä¸­åˆ†åˆ«è¾“å…¥ä¸åŒçš„å†…å®¹</li>
				<li>ç‚¹å‡»å¯¹åº”çš„ä¿å­˜æŒ‰é’®</li>
				<li>ç‚¹å‡»"æ‰“å¼€æ–°æ ‡ç­¾é¡µæµ‹è¯•"</li>
				<li>è§‚å¯Ÿæ–°æ ‡ç­¾é¡µä¸­çš„æ•°æ®ï¼š
					<ul>
						<li><strong>localStorageæ•°æ®</strong> ä¼šå‡ºç°åœ¨æ–°æ ‡ç­¾é¡µä¸­</li>
						<li><strong>sessionStorageæ•°æ®</strong> åœ¨æ–°æ ‡ç­¾é¡µä¸­æ˜¯ç©ºçš„</li>
					</ul>
				</li>
				<li>å…³é—­æ‰€æœ‰æ ‡ç­¾é¡µï¼Œé‡æ–°æ‰“å¼€ç½‘ç«™</li>
				<li>è§‚å¯Ÿæ•°æ®ï¼š
					<ul>
						<li><strong>localStorageæ•°æ®</strong> ä»ç„¶å­˜åœ¨</li>
						<li><strong>sessionStorageæ•°æ®</strong> å·²ç»æ¶ˆå¤±</li>
					</ul>
				</li>
			</ol>
		</div>
	</div>
	
	{#if testMessage}
		<div class="message">
			{testMessage}
		</div>
	{/if}
	
	<div class="use-cases">
		<h2>ğŸ’¡ ä½¿ç”¨åœºæ™¯</h2>
		<div class="cases-grid">
			<div class="case local-case">
				<h3>localStorageé€‚åˆï¼š</h3>
				<ul>
					<li>ç”¨æˆ·åå¥½è®¾ç½®ï¼ˆä¸»é¢˜ã€è¯­è¨€ï¼‰</li>
					<li>ç™»å½•çŠ¶æ€</li>
					<li>è´­ç‰©è½¦å†…å®¹</li>
					<li>ç”¨æˆ·è‡ªå®šä¹‰é…ç½®</li>
					<li>ç¦»çº¿æ•°æ®ç¼“å­˜</li>
				</ul>
			</div>
			
			<div class="case session-case">
				<h3>sessionStorageé€‚åˆï¼š</h3>
				<ul>
					<li>è¡¨å•è‰ç¨¿</li>
					<li>å¤šæ­¥éª¤è¡¨å•çš„å½“å‰æ­¥éª¤</li>
					<li>ä¸´æ—¶æœç´¢å†å²</li>
					<li>é¡µé¢é—´ä¼ é€’çš„ä¸´æ—¶æ•°æ®</li>
					<li>ä¼šè¯çº§åˆ«çš„çŠ¶æ€ç®¡ç†</li>
				</ul>
			</div>
		</div>
	</div>
</div>

<style>
	.container {
		max-width: 1000px;
		margin: 0 auto;
		padding: 20px;
		font-family: system-ui, sans-serif;
	}
	
	.comparison-grid {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 20px;
		margin: 30px 0;
	}
	
	.storage-section {
		padding: 20px;
		border-radius: 8px;
		border: 2px solid;
	}
	
	.local {
		border-color: #2196f3;
		background: #e3f2fd;
	}
	
	.session {
		border-color: #ff9800;
		background: #fff3e0;
	}
	
	.features {
		margin: 15px 0;
	}
	
	.features p {
		margin: 8px 0;
		font-size: 14px;
	}
	
	.demo-area {
		margin: 20px 0;
	}
	
	textarea {
		width: 100%;
		padding: 10px;
		border: 1px solid #ddd;
		border-radius: 4px;
		font-family: inherit;
		resize: vertical;
		box-sizing: border-box;
	}
	
	.buttons {
		display: flex;
		gap: 10px;
		margin-top: 10px;
	}
	
	button {
		padding: 8px 16px;
		border: none;
		border-radius: 4px;
		cursor: pointer;
		font-size: 14px;
		transition: background-color 0.2s;
	}
	
	.save {
		background: #4caf50;
		color: white;
	}
	
	.save:hover {
		background: #45a049;
	}
	
	.clear {
		background: #f44336;
		color: white;
	}
	
	.clear:hover {
		background: #da190b;
	}
	
	.test {
		background: #9c27b0;
		color: white;
	}
	
	.test:hover {
		background: #7b1fa2;
	}
	
	.test-section {
		background: #f5f5f5;
		padding: 20px;
		border-radius: 8px;
		margin: 30px 0;
	}
	
	.test-buttons {
		margin: 20px 0;
	}
	
	.instructions {
		background: white;
		padding: 20px;
		border-radius: 6px;
		border-left: 4px solid #2196f3;
	}
	
	.instructions ol {
		margin: 10px 0;
		padding-left: 20px;
	}
	
	.instructions li {
		margin: 8px 0;
	}
	
	.instructions ul {
		margin: 8px 0;
		padding-left: 20px;
	}
	
	.message {
		background: #d4edda;
		color: #155724;
		padding: 15px;
		border-radius: 4px;
		border: 1px solid #c3e6cb;
		margin: 20px 0;
		text-align: center;
		font-weight: bold;
	}
	
	.use-cases {
		margin: 40px 0;
	}
	
	.cases-grid {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 20px;
		margin: 20px 0;
	}
	
	.case {
		padding: 20px;
		border-radius: 8px;
		border: 2px solid;
	}
	
	.local-case {
		border-color: #2196f3;
		background: #e3f2fd;
	}
	
	.session-case {
		border-color: #ff9800;
		background: #fff3e0;
	}
	
	.case ul {
		margin: 10px 0;
		padding-left: 20px;
	}
	
	.case li {
		margin: 6px 0;
	}
	
	@media (max-width: 768px) {
		.comparison-grid,
		.cases-grid {
			grid-template-columns: 1fr;
		}
	}
</style> 