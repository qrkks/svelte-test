# 审批系统开发文档

## 概述

本审批系统采用折衷方案设计，专为协会管理系统定制，使用Svelte 5 runes语法开发。系统具有简单易用、扩展性好的特点，适合个人开发维护。

## 技术栈

- **前端**: SvelteKit 2.x + Svelte 5 (runes语法)
- **数据库**: SQLite + Drizzle ORM
- **UI**: Tailwind CSS
- **类型**: TypeScript

## 数据库设计

### 核心表结构

```typescript
// 1. 审批流程定义表
export const approvalFlow = sqliteTable('approval_flow', {
  id: integer('id').primaryKey({ autoIncrement: true }),
  name: text('name').notNull(),
  code: text('code').notNull().unique(), // 如：membership_approval
  description: text('description'),
  flowConfig: text('flow_config').notNull(), // JSON字符串
  status: text('status').notNull().default('active'),
  createdAt: text('created_at').notNull().default(sql`CURRENT_TIMESTAMP`)
});

// 2. 审批申请表
export const approvalRequest = sqliteTable('approval_request', {
  id: integer('id').primaryKey({ autoIncrement: true }),
  requestNo: text('request_no').notNull().unique(),
  flowId: integer('flow_id').notNull().references(() => approvalFlow.id),
  applicantId: integer('applicant_id').notNull().references(() => user.id),
  organizationId: integer('organization_id').references(() => organization.id),
  title: text('title').notNull(),
  content: text('content'),
  data: text('data'), // JSON业务数据
  status: text('status').notNull().default('pending'), // pending, approved, rejected, cancelled
  currentStep: integer('current_step').default(1),
  createdAt: text('created_at').notNull().default(sql`CURRENT_TIMESTAMP`),
  updatedAt: text('updated_at').notNull().default(sql`CURRENT_TIMESTAMP`),
  completedAt: integer('completed_at', { mode: 'timestamp' })
});

// 3. 审批记录表
export const approvalRecord = sqliteTable('approval_record', {
  id: integer('id').primaryKey({ autoIncrement: true }),
  requestId: integer('request_id').notNull().references(() => approvalRequest.id),
  stepOrder: integer('step_order').notNull(),
  stepName: text('step_name').notNull(),
  approverId: integer('approver_id').notNull().references(() => user.id),
  action: text('action').notNull(), // approve, reject, return
  comment: text('comment'),
  createdAt: text('created_at').notNull().default(sql`CURRENT_TIMESTAMP`)
});
```

## 预定义审批流程

### 协会常用审批流程

```typescript
// 会员申请审批
const membershipApprovalFlow = {
  name: '会员申请审批',
  code: 'membership_approval',
  flowConfig: JSON.stringify({
    steps: [
      {
        stepOrder: 1,
        stepName: '秘书处审核',
        approverType: 'role',
        approverConfig: { roleId: 'secretary' },
        timeoutHours: 48
      },
      {
        stepOrder: 2,
        stepName: '会长审批',
        approverType: 'role',
        approverConfig: { roleId: 'president' },
        timeoutHours: 72
      }
    ]
  })
};

// 活动申请审批
const eventApprovalFlow = {
  name: '活动申请审批',
  code: 'event_approval',
  flowConfig: JSON.stringify({
    steps: [
      {
        stepOrder: 1,
        stepName: '部门审核',
        approverType: 'supervisor',
        timeoutHours: 24
      },
      {
        stepOrder: 2,
        stepName: '秘书长审批',
        approverType: 'role',
        approverConfig: { roleId: 'secretary_general' },
        timeoutHours: 48
      }
    ]
  })
};

// 费用报销审批
const expenseApprovalFlow = {
  name: '费用报销审批',
  code: 'expense_approval',
  flowConfig: JSON.stringify({
    steps: [
      {
        stepOrder: 1,
        stepName: '部门审核',
        approverType: 'supervisor',
        timeoutHours: 24
      },
      {
        stepOrder: 2,
        stepName: '财务审核',
        approverType: 'role',
        approverConfig: { roleId: 'finance_manager' },
        timeoutHours: 48
      },
      {
        stepOrder: 3,
        stepName: '会长审批',
        approverType: 'role',
        approverConfig: { roleId: 'president' },
        condition: {
          field: 'amount',
          operator: '>',
          value: 5000
        },
        timeoutHours: 72
      }
    ]
  })
};
```

## 核心服务类

### 审批服务 (ApprovalService)

```typescript
// src/lib/server/services/approvalService.ts
import { db } from '$lib/server/db';
import { approvalFlow, approvalRequest, approvalRecord } from '$lib/server/db/schema';
import { eq, and, desc } from 'drizzle-orm';

export class ApprovalService {
  // 提交审批申请
  async submitRequest(data: {
    flowCode: string;
    applicantId: number;
    organizationId?: number;
    title: string;
    content?: string;
    data?: any;
  }) {
    // 1. 获取流程配置
    const flow = await db.query.approvalFlow.findFirst({
      where: eq(approvalFlow.code, data.flowCode)
    });
    
    if (!flow) {
      throw new Error('审批流程不存在');
    }
    
    // 2. 生成申请编号
    const requestNo = this.generateRequestNo();
    
    // 3. 创建申请
    const request = await db.insert(approvalRequest).values({
      requestNo,
      flowId: flow.id,
      applicantId: data.applicantId,
      organizationId: data.organizationId,
      title: data.title,
      content: data.content,
      data: data.data ? JSON.stringify(data.data) : null,
      status: 'pending',
      currentStep: 1
    }).returning();
    
    // 4. 确定第一个审批人
    const config = JSON.parse(flow.flowConfig);
    const firstStep = config.steps[0];
    const approver = await this.resolveApprover(firstStep, request[0]);
    
    // 5. 发送通知
    await this.sendNotification(request[0], approver);
    
    return request[0];
  }
  
  // 审批处理
  async processApproval(data: {
    requestId: number;
    approverId: number;
    action: 'approve' | 'reject' | 'return';
    comment?: string;
  }) {
    // 1. 获取申请信息
    const request = await db.query.approvalRequest.findFirst({
      where: eq(approvalRequest.id, data.requestId)
    });
    
    if (!request) {
      throw new Error('审批申请不存在');
    }
    
    // 2. 验证审批权限
    const hasPermission = await this.checkApprovalPermission(
      data.approverId, 
      request.id
    );
    
    if (!hasPermission) {
      throw new Error('无审批权限');
    }
    
    // 3. 创建审批记录
    await db.insert(approvalRecord).values({
      requestId: data.requestId,
      stepOrder: request.currentStep,
      stepName: `步骤${request.currentStep}`,
      approverId: data.approverId,
      action: data.action,
      comment: data.comment
    });
    
    // 4. 更新申请状态
    if (data.action === 'reject') {
      await db.update(approvalRequest)
        .set({ 
          status: 'rejected',
          updatedAt: new Date().toISOString(),
          completedAt: new Date()
        })
        .where(eq(approvalRequest.id, data.requestId));
    } else {
      // 确定下一步审批人
      const nextStep = await this.getNextStep(request);
      if (nextStep) {
        await db.update(approvalRequest)
          .set({ 
            currentStep: nextStep.stepOrder,
            updatedAt: new Date().toISOString()
          })
          .where(eq(approvalRequest.id, data.requestId));
        
        // 发送通知给下一步审批人
        await this.sendNotification(request, nextStep.approver);
      } else {
        // 审批完成
        await db.update(approvalRequest)
          .set({ 
            status: 'approved',
            updatedAt: new Date().toISOString(),
            completedAt: new Date()
          })
          .where(eq(approvalRequest.id, data.requestId));
      }
    }
    
    return { success: true };
  }
  
  // 获取待办列表
  async getTodoList(userId: number) {
    // 获取用户需要审批的申请
    const requests = await db.query.approvalRequest.findMany({
      where: and(
        eq(approvalRequest.status, 'pending'),
        // 这里需要根据审批人逻辑查询
      ),
      with: {
        applicant: true,
        flow: true
      },
      orderBy: desc(approvalRequest.createdAt)
    });
    
    return requests;
  }
  
  // 获取审批历史
  async getApprovalHistory(requestId: number) {
    const records = await db.query.approvalRecord.findMany({
      where: eq(approvalRecord.requestId, requestId),
      with: {
        approver: true
      },
      orderBy: approvalRecord.createdAt
    });
    
    return records;
  }
  
  // 获取统计信息
  async getStatistics(userId: number) {
    const [total, pending, approved, rejected] = await Promise.all([
      db.select({ count: sql`count(*)` }).from(approvalRequest),
      db.select({ count: sql`count(*)` }).from(approvalRequest).where(eq(approvalRequest.status, 'pending')),
      db.select({ count: sql`count(*)` }).from(approvalRequest).where(eq(approvalRequest.status, 'approved')),
      db.select({ count: sql`count(*)` }).from(approvalRequest).where(eq(approvalRequest.status, 'rejected'))
    ]);
    
    return {
      total: total[0]?.count || 0,
      pending: pending[0]?.count || 0,
      approved: approved[0]?.count || 0,
      rejected: rejected[0]?.count || 0,
      averageDuration: 0 // 需要计算平均时长
    };
  }
  
  // 私有方法
  private generateRequestNo(): string {
    return `AP${Date.now()}${Math.random().toString(36).substr(2, 5)}`;
  }
  
  private async resolveApprover(stepConfig: any, request: any) {
    // 根据配置确定审批人
    switch (stepConfig.approverType) {
      case 'supervisor':
        return await this.getSupervisor(request.applicantId);
      case 'role':
        return await this.getUsersByRole(stepConfig.approverConfig.roleId);
      case 'user':
        return [stepConfig.approverConfig.userId];
      default:
        throw new Error('未知的审批人类型');
    }
  }
  
  private async getSupervisor(userId: number) {
    // 获取用户的直接主管
    // 这里需要根据您的组织架构实现
    return [];
  }
  
  private async getUsersByRole(roleId: number) {
    // 根据角色获取用户列表
    // 这里需要根据您的权限系统实现
    return [];
  }
  
  private async checkApprovalPermission(userId: number, requestId: number) {
    // 检查用户是否有审批权限
    // 这里需要根据您的权限系统实现
    return true;
  }
  
  private async getNextStep(request: any) {
    // 获取下一步审批信息
    // 这里需要根据流程配置实现
    return null;
  }
  
  private async sendNotification(request: any, approver: any) {
    // 发送通知
    // 这里需要集成您的通知系统
  }
}
```

## 前端组件 (使用Svelte 5 runes语法)

### 审批中心页面

```svelte
<!-- src/routes/approval/+page.svelte -->
<script lang="ts">
  import type { PageProps } from './$types';
  import ApprovalCard from '$lib/components/approval/ApprovalCard.svelte';
  import ApprovalStats from '$lib/components/approval/ApprovalStats.svelte';
  
  let { data }: PageProps = $props();
  
  // 使用runes语法定义响应式状态
  let { todoList, stats } = $state({
    todoList: data.todoList || [],
    stats: data.stats || {}
  });
  
  let { activeTab } = $state('todo');
  
  // 响应式函数
  let { filteredList } = $derived(() => {
    if (activeTab === 'todo') {
      return todoList.filter(item => item.status === 'pending');
    } else if (activeTab === 'approved') {
      return todoList.filter(item => item.status === 'approved');
    } else if (activeTab === 'rejected') {
      return todoList.filter(item => item.status === 'rejected');
    }
    return todoList;
  });
  
  // 处理审批操作
  async function handleApproval(requestId: number, action: string, comment?: string) {
    try {
      const response = await fetch('/api/approval/process', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ requestId, action, comment })
      });
      
      if (response.ok) {
        // 更新列表
        todoList = todoList.map(item => 
          item.id === requestId 
            ? { ...item, status: action === 'approve' ? 'approved' : 'rejected' }
            : item
        );
      }
    } catch (error) {
      console.error('审批失败:', error);
    }
  }
</script>

<div class="container mx-auto px-4 py-8">
  <h1 class="text-3xl font-bold mb-8">审批中心</h1>
  
  <!-- 统计信息 -->
  <ApprovalStats {stats} />
  
  <!-- 标签页 -->
  <div class="flex space-x-4 mb-6">
    <button 
      class="px-4 py-2 rounded {activeTab === 'todo' ? 'bg-blue-500 text-white' : 'bg-gray-200'}"
      onclick={() => activeTab = 'todo'}
    >
      待办 ({todoList.filter(item => item.status === 'pending').length})
    </button>
    <button 
      class="px-4 py-2 rounded {activeTab === 'approved' ? 'bg-blue-500 text-white' : 'bg-gray-200'}"
      onclick={() => activeTab = 'approved'}
    >
      已通过 ({todoList.filter(item => item.status === 'approved').length})
    </button>
    <button 
      class="px-4 py-2 rounded {activeTab === 'rejected' ? 'bg-blue-500 text-white' : 'bg-gray-200'}"
      onclick={() => activeTab = 'rejected'}
    >
      已拒绝 ({todoList.filter(item => item.status === 'rejected').length})
    </button>
  </div>
  
  <!-- 审批列表 -->
  <div class="space-y-4">
    {#each filteredList as request (request.id)}
      <ApprovalCard 
        {request} 
        on:approve={(e) => handleApproval(request.id, 'approve', e.detail)}
        on:reject={(e) => handleApproval(request.id, 'reject', e.detail)}
      />
    {/each}
  </div>
  
  {#if filteredList.length === 0}
    <div class="text-center py-8 text-gray-500">
      暂无{activeTab === 'todo' ? '待办' : activeTab === 'approved' ? '已通过' : '已拒绝'}的审批
    </div>
  {/if}
</div>
```

### 审批卡片组件

```svelte
<!-- src/lib/components/approval/ApprovalCard.svelte -->
<script lang="ts">
  import { createEventDispatcher } from 'svelte';
  import type { ApprovalRequest } from '$lib/types/approval';
  
  export let request: ApprovalRequest;
  
  const dispatch = createEventDispatcher();
  
  // 使用runes语法定义响应式状态
  let { showComment, comment, isProcessing } = $state({
    showComment: false,
    comment: '',
    isProcessing: false
  });
  
  // 处理审批
  async function handleApproval(action: 'approve' | 'reject') {
    if (action === 'reject' && !comment.trim()) {
      showComment = true;
      return;
    }
    
    isProcessing = true;
    
    try {
      dispatch(action, comment);
      comment = '';
      showComment = false;
    } finally {
      isProcessing = false;
    }
  }
  
  // 格式化时间
  function formatDate(date: string) {
    return new Date(date).toLocaleString('zh-CN');
  }
  
  // 获取状态颜色
  function getStatusColor(status: string) {
    switch (status) {
      case 'pending': return 'bg-yellow-100 text-yellow-800';
      case 'approved': return 'bg-green-100 text-green-800';
      case 'rejected': return 'bg-red-100 text-red-800';
      default: return 'bg-gray-100 text-gray-800';
    }
  }
</script>

<div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500">
  <div class="flex justify-between items-start mb-4">
    <div>
      <h3 class="text-lg font-semibold text-gray-900">{request.title}</h3>
      <p class="text-sm text-gray-600 mt-1">申请编号: {request.requestNo}</p>
      <p class="text-sm text-gray-600">申请人: {request.applicant?.username}</p>
      <p class="text-sm text-gray-600">申请时间: {formatDate(request.createdAt)}</p>
    </div>
    
    <span class="px-2 py-1 rounded-full text-xs font-medium {getStatusColor(request.status)}">
      {request.status === 'pending' ? '待审批' : 
       request.status === 'approved' ? '已通过' : '已拒绝'}
    </span>
  </div>
  
  {#if request.content}
    <div class="mb-4">
      <p class="text-gray-700">{request.content}</p>
    </div>
  {/if}
  
  {#if request.data}
    <div class="mb-4">
      <h4 class="text-sm font-medium text-gray-900 mb-2">申请详情:</h4>
      <pre class="bg-gray-50 p-3 rounded text-sm overflow-x-auto">
        {JSON.stringify(JSON.parse(request.data), null, 2)}
      </pre>
    </div>
  {/if}
  
  {#if request.status === 'pending'}
    <div class="flex space-x-3">
      <button 
        class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50"
        disabled={isProcessing}
        onclick={() => handleApproval('approve')}
      >
        {isProcessing ? '处理中...' : '同意'}
      </button>
      
      <button 
        class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50"
        disabled={isProcessing}
        onclick={() => handleApproval('reject')}
      >
        {isProcessing ? '处理中...' : '拒绝'}
      </button>
    </div>
    
    {#if showComment}
      <div class="mt-4">
        <textarea 
          bind:value={comment}
          placeholder="请输入审批意见..."
          class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          rows="3"
        />
        <div class="flex space-x-3 mt-2">
          <button 
            class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"
            onclick={() => handleApproval('reject')}
          >
            确认拒绝
          </button>
          <button 
            class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600"
            onclick={() => showComment = false}
          >
            取消
          </button>
        </div>
      </div>
    {/if}
  {/if}
</div>
```

### 审批统计组件

```svelte
<!-- src/lib/components/approval/ApprovalStats.svelte -->
<script lang="ts">
  export let stats: {
    total: number;
    pending: number;
    approved: number;
    rejected: number;
    averageDuration: number;
  };
  
  // 使用runes语法定义计算属性
  let { approvalRate } = $derived(() => {
    if (stats.total === 0) return 0;
    return Math.round((stats.approved / stats.total) * 100);
  });
  
  let { averageDurationText } = $derived(() => {
    if (stats.averageDuration === 0) return '暂无数据';
    const hours = Math.floor(stats.averageDuration / 3600);
    const minutes = Math.floor((stats.averageDuration % 3600) / 60);
    return `${hours}小时${minutes}分钟`;
  });
</script>

<div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-8">
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-blue-100">
        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-600">总申请数</p>
        <p class="text-2xl font-semibold text-gray-900">{stats.total}</p>
      </div>
    </div>
  </div>
  
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-yellow-100">
        <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-600">待审批</p>
        <p class="text-2xl font-semibold text-gray-900">{stats.pending}</p>
      </div>
    </div>
  </div>
  
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-green-100">
        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-600">已通过</p>
        <p class="text-2xl font-semibold text-gray-900">{stats.approved}</p>
      </div>
    </div>
  </div>
  
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-red-100">
        <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-600">已拒绝</p>
        <p class="text-2xl font-semibold text-gray-900">{stats.rejected}</p>
      </div>
    </div>
  </div>
  
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-purple-100">
        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-600">平均时长</p>
        <p class="text-2xl font-semibold text-gray-900">{averageDurationText}</p>
      </div>
    </div>
  </div>
</div>

<div class="bg-white rounded-lg shadow p-6 mb-8">
  <h3 class="text-lg font-semibold text-gray-900 mb-4">审批通过率</h3>
  <div class="flex items-center">
    <div class="flex-1 bg-gray-200 rounded-full h-4">
      <div 
        class="bg-green-500 h-4 rounded-full transition-all duration-300"
        style="width: {approvalRate}%"
      />
    </div>
    <span class="ml-4 text-sm font-medium text-gray-600">{approvalRate}%</span>
  </div>
</div>
```

## Runes语法特点

### 1. $state - 响应式状态
```typescript
// 定义响应式状态
let { todoList, stats } = $state({
  todoList: [],
  stats: {}
});

let { activeTab } = $state('todo');
```

### 2. $derived - 计算属性
```typescript
// 响应式计算属性
let { filteredList } = $derived(() => {
  if (activeTab === 'todo') {
    return todoList.filter(item => item.status === 'pending');
  }
  return todoList;
});

let { approvalRate } = $derived(() => {
  if (stats.total === 0) return 0;
  return Math.round((stats.approved / stats.total) * 100);
});
```

### 3. $props - 组件属性
```typescript
// 获取组件属性
let { data }: PageProps = $props();
export let request: ApprovalRequest;
```

## 类型定义

```typescript
// src/lib/types/approval.ts
export interface ApprovalRequest {
  id: number;
  requestNo: string;
  flowId: number;
  applicantId: number;
  organizationId?: number;
  title: string;
  content?: string;
  data?: string;
  status: 'pending' | 'approved' | 'rejected' | 'cancelled';
  currentStep: number;
  createdAt: string;
  updatedAt: string;
  completedAt?: string;
  applicant?: {
    id: number;
    username: string;
  };
  flow?: {
    id: number;
    name: string;
    code: string;
  };
}

export interface ApprovalRecord {
  id: number;
  requestId: number;
  stepOrder: number;
  stepName: string;
  approverId: number;
  action: 'approve' | 'reject' | 'return';
  comment?: string;
  createdAt: string;
  approver?: {
    id: number;
    username: string;
  };
}

export interface ApprovalFlow {
  id: number;
  name: string;
  code: string;
  description?: string;
  flowConfig: string;
  status: string;
  createdAt: string;
}

export interface ApprovalStats {
  total: number;
  pending: number;
  approved: number;
  rejected: number;
  averageDuration: number;
}
```

## 使用说明

### 1. 提交审批申请

```typescript
// 前端调用
const response = await fetch('/api/approval', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    flowCode: 'membership_approval',
    title: '张三的会员申请',
    content: '申请加入协会',
    data: {
      memberName: '张三',
      memberType: '个人会员',
      contactInfo: '13800138000'
    }
  })
});
```

### 2. 审批处理

```typescript
// 前端调用
const response = await fetch('/api/approval/process', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    requestId: 123,
    action: 'approve',
    comment: '同意申请'
  })
});
```

## 开发计划

### 第一阶段：MVP (1周)
- [x] 数据库设计
- [x] 核心服务类
- [x] 基础UI组件
- [x] API接口
- [x] 审批流程

### 第二阶段：功能完善 (1周)
- [ ] 审批历史
- [ ] 通知集成
- [ ] 统计功能
- [ ] 权限控制

### 第三阶段：优化完善 (1周)
- [ ] 用户体验优化
- [ ] 性能优化
- [ ] 文档完善
- [ ] 测试用例

## 注意事项

1. **权限控制**：确保只有有权限的用户才能进行审批操作
2. **数据验证**：前端和后端都要进行数据验证
3. **错误处理**：妥善处理各种异常情况
4. **性能优化**：对于大量数据，考虑分页和缓存
5. **安全考虑**：防止SQL注入、XSS等安全问题

## 优势

1. **简洁性**：Runes语法比传统的响应式语法更简洁
2. **性能**：更好的编译时优化
3. **类型安全**：更好的TypeScript支持
4. **学习成本**：更直观的语法，易于理解

## 开发建议

1. **逐步迁移**：可以逐步将现有组件迁移到Runes语法
2. **保持一致性**：在项目中统一使用Runes语法
3. **文档完善**：为团队编写Runes语法的使用指南
4. **测试覆盖**：确保迁移后的组件功能正常 